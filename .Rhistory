filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace)
###expected differences Hypothesis 2
#get predictions for extrapolated distance with gravity only
GetModelResponses = air_drag %>%
mutate(cd = case_when(
airdrag == "Airdrag" ~ 0.535,
airdrag == "NoAirdrag" ~ 0),
vy = case_when(
TTC == 1.0 ~ 4.9035,
TTC == 1.2 ~ 5.8842,
TTC == 1.4 ~ 6.8649),
m = case_when(
r == 0.033 ~ 0.06,
r == 0.12 ~ 0.6),
A = pi * r^2,
rho = 1.225,
D = rho*cd*A/2,
D_WithAD = rho*0.535*A/2) %>%
group_by(airdrag,TTC,r,vx) %>%
slice(1)
i = 1
dt = 0.001
GetModelResponses$Last_x = 0
GetModelResponses$Last_y = 0
GetModelResponses$Last_t = 0
GetModelResponses$xAtDisappearance = 0
GetModelResponses$Last_vx = 0
GetModelResponses$Last_vy = 0
GetModelResponses$vxAtDisappearance = 0
GetModelResponses$vyAtDisappearance = 0
for (i in (1:length(GetModelResponses$trial))){
D = GetModelResponses[i,]$D
D2 = GetModelResponses[i,]$D_WithAD
vx = GetModelResponses[i,]$vx
vy = GetModelResponses[i,]$vy
m = GetModelResponses[i,]$m
TTC = GetModelResponses[i,]$TTC
OccludedPercentage = 0.575
g = 9.807
t = 0
y = 0
x = 0
Got_X = 0
for (j in seq(0,1.5,dt)){
if (y >= 0){
if (t > OccludedPercentage*TTC){
D = 0
if (Got_X == 0){
xAtDisappearance = x
vxAtDisappearance = vx
vyAtDisappearance = vy
Got_X = 1
}
}
v = sqrt(vx^2+vy^2)
ax <- -(D/m)*v*vx
ay <- -g - (D/m)*v*vy
vx = vx + ax * dt
vy = vy + ay * dt
x = x + vx * dt + 0.5*ax*dt^2
y = y + vy * dt + 0.5*ay*dt^2
t = t + dt
}
}
GetModelResponses$Last_x[i] = x
GetModelResponses$Last_y[i] = y
GetModelResponses$Last_t[i] = t
GetModelResponses$Last_vx[i] = vx
GetModelResponses$Last_vy[i] = vy
GetModelResponses$xAtDisappearance[i] = xAtDisappearance
GetModelResponses$vxAtDisappearance[i] = vxAtDisappearance
GetModelResponses$vyAtDisappearance[i] = vyAtDisappearance
}
GetModelResponses = GetModelResponses %>%
select(airdrag,TTC,vy,r,vx,Last_x,Last_t,Last_vx,Last_vy,xAtDisappearance,vxAtDisappearance,vyAtDisappearance) %>%
mutate(tAtDisappearance = TTC*0.575,
ErrorSpace = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_x-TTC*vx,
),
ErrorTime = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_t-TTC,
),
ExtrapolatedSpace_Model = Last_x - xAtDisappearance,
ExtrapolatedTime_Model = Last_t - tAtDisappearance,
ErrorRatioSpace = (ErrorSpace+ExtrapolatedSpace_Model)/ExtrapolatedSpace_Model,
ErrorRatioTime = (ErrorTime+ExtrapolatedSpace_Model/ExtrapolatedTime_Model)
)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
GetModelResponses
GetModelResponses = GetModelResponses %>%
select(airdrag,TTC,vy,r,vx,Last_x,Last_t,Last_vx,Last_vy,xAtDisappearance,vxAtDisappearance,vyAtDisappearance) %>%
mutate(tAtDisappearance = TTC*0.575,
ErrorSpace = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_x-x_max,
),
ErrorTime = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_t-t_max,
),
ExtrapolatedSpace_Model = Last_x - xAtDisappearance,
ExtrapolatedTime_Model = Last_t - tAtDisappearance,
ErrorRatioSpace = (ErrorSpace+ExtrapolatedSpace_Model)/ExtrapolatedSpace_Model,
ErrorRatioTime = (ErrorTime+ExtrapolatedSpace_Model/ExtrapolatedTime_Model)
)
###expected differences Hypothesis 2
#get predictions for extrapolated distance with gravity only
GetModelResponses = air_drag %>%
mutate(cd = case_when(
airdrag == "Airdrag" ~ 0.535,
airdrag == "NoAirdrag" ~ 0),
vy = case_when(
TTC == 1.0 ~ 4.9035,
TTC == 1.2 ~ 5.8842,
TTC == 1.4 ~ 6.8649),
m = case_when(
r == 0.033 ~ 0.06,
r == 0.12 ~ 0.6),
A = pi * r^2,
rho = 1.225,
D = rho*cd*A/2,
D_WithAD = rho*0.535*A/2) %>%
group_by(airdrag,TTC,r,vx) %>%
slice(1)
i = 1
dt = 0.001
GetModelResponses$Last_x = 0
GetModelResponses$Last_y = 0
GetModelResponses$Last_t = 0
GetModelResponses$xAtDisappearance = 0
GetModelResponses$Last_vx = 0
GetModelResponses$Last_vy = 0
GetModelResponses$vxAtDisappearance = 0
GetModelResponses$vyAtDisappearance = 0
for (i in (1:length(GetModelResponses$trial))){
D = GetModelResponses[i,]$D
D2 = GetModelResponses[i,]$D_WithAD
vx = GetModelResponses[i,]$vx
vy = GetModelResponses[i,]$vy
m = GetModelResponses[i,]$m
TTC = GetModelResponses[i,]$TTC
OccludedPercentage = 0.575
g = 9.807
t = 0
y = 0
x = 0
Got_X = 0
for (j in seq(0,1.5,dt)){
if (y >= 0){
if (t > OccludedPercentage*TTC){
D = 0
if (Got_X == 0){
xAtDisappearance = x
vxAtDisappearance = vx
vyAtDisappearance = vy
Got_X = 1
}
}
v = sqrt(vx^2+vy^2)
ax <- -(D/m)*v*vx
ay <- -g - (D/m)*v*vy
vx = vx + ax * dt
vy = vy + ay * dt
x = x + vx * dt + 0.5*ax*dt^2
y = y + vy * dt + 0.5*ay*dt^2
t = t + dt
}
}
GetModelResponses$Last_x[i] = x
GetModelResponses$Last_y[i] = y
GetModelResponses$Last_t[i] = t
GetModelResponses$Last_vx[i] = vx
GetModelResponses$Last_vy[i] = vy
GetModelResponses$xAtDisappearance[i] = xAtDisappearance
GetModelResponses$vxAtDisappearance[i] = vxAtDisappearance
GetModelResponses$vyAtDisappearance[i] = vyAtDisappearance
}
GetModelResponses = GetModelResponses %>%
select(airdrag,TTC,vy,r,vx,Last_x,Last_t,Last_vx,Last_vy,xAtDisappearance,vxAtDisappearance,vyAtDisappearance,x_max,t_max) %>%
mutate(tAtDisappearance = TTC*0.575,
ErrorSpace = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_x-x_max,
),
ErrorTime = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_t-t_max,
),
ExtrapolatedSpace_Model = Last_x - xAtDisappearance,
ExtrapolatedTime_Model = Last_t - tAtDisappearance,
ErrorRatioSpace = (ErrorSpace+ExtrapolatedSpace_Model)/ExtrapolatedSpace_Model,
ErrorRatioTime = (ErrorTime+ExtrapolatedSpace_Model/ExtrapolatedTime_Model)
)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
GetModelResponses$ExtrapolatedTime_Model
GetModelResponses$ExtrapolatedSpace_Model
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
GetModelResponses = GetModelResponses %>%
select(airdrag,TTC,vy,r,vx,Last_x,Last_t,Last_vx,Last_vy,xAtDisappearance,vxAtDisappearance,vyAtDisappearance,x_max,t_max) %>%
mutate(tAtDisappearance = TTC*0.575,
ErrorSpace = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_x-x_max,
),
ErrorTime = case_when(
airdrag == "NoAirdrag" ~ 0,
airdrag == "Airdrag" ~ Last_t-t_max,
),
ExtrapolatedSpace_Model = Last_x - xAtDisappearance,
ExtrapolatedTime_Model = Last_t - tAtDisappearance,
ErrorRatioSpace = (ErrorSpace+ExtrapolatedSpace_Model)/ExtrapolatedSpace_Model,
ErrorRatioTime = (ErrorTime+ExtrapolatedTime_Model/ExtrapolatedTime_Model)
)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
####Space, by TTCs
unique((GetModelResponses %>%
filter(r == 0.12) %>%
select(ExtrapolatedSpace_Model) %>%
group_by(TTC) %>%
mutate(Mean = mean(ExtrapolatedSpace_Model)))$Mean) -
unique((GetModelResponses %>%
filter(r == 0.033) %>%
select(ExtrapolatedSpace_Model) %>%
group_by(TTC) %>%
mutate(Mean = mean(ExtrapolatedSpace_Model)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(r == 0.12))$ExtrapolatedSpace_Model) -
mean((GetModelResponses %>%
filter(r == 0.033))$ExtrapolatedSpace_Model)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
####Space, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorSpace) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorSpace)))$Mean)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
####Time, by TTCs
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean) -
unique((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033) %>%
select(ErrorTime) %>%
group_by(TTC) %>%
mutate(Mean = mean(ErrorTime)))$Mean)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
###Time Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioTime) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioTime)
###Space Ratio
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.12))$ErrorRatioSpace) -
mean((GetModelResponses %>%
filter(airdrag == "Airdrag" & r == 0.033))$ErrorRatioSpace)
